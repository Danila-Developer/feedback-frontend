import React from 'react'
import { useRef, useEffect } from 'react'

import classes from './Rating.module.css'

export default function Rating({rating, ...props}) {
    const ratingWrapper = useRef()

    useEffect(() => {
        const ratingStars = Array.from(ratingWrapper.current.childNodes)
        const fullStarsCount = Math.floor(rating)
        for (let i = 0; i < fullStarsCount; i++) {
            ratingStars[i].classList.add(classes.star_full)
        }
        if (rating < 5 && rating > 0 && (rating - fullStarsCount) != 0) {
            const partStar = document.createElement('div')
            partStar.classList.add(classes.rating_star_part)
            partStar.innerHTML = '★'
            partStar.style.width = `${(+rating - fullStarsCount)*100}%`
            ratingStars[fullStarsCount].appendChild(partStar)
        }
    }, [])

    return (
        <div className={classes.rating_wrapper} ref={ratingWrapper}>
            <div className={classes.rating_star}>★</div>
            <div className={classes.rating_star}>★</div>
            <div className={classes.rating_star}>★</div>
            <div className={classes.rating_star}>★</div>
            <div className={classes.rating_star}>★</div>
        </div>
    )
}
