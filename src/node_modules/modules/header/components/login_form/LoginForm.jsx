import {useForm} from "react-hook-form";
import {useDispatch, useSelector} from "react-redux";

import classes from "modules/header/components/auth_modal/AuthModal.module.css";
import Input from "UI/input/Input";
import SubmitInput from 'UI/submit_input/SubmitInput'
import {getAuthorizationUserAction, getLoginUserAction} from 'modules/header/store/user_store/actionCreator'
import {getAuthModalOffAction} from 'modules/header/store/auth_modal_store/actionCreator'


const LoginForm = () => {
    const dispatch = useDispatch()
    const {
        register,
        formState: {errors},
        handleSubmit,
        reset
    } = useForm({mode: 'onBlur'})

    const onLoginFormSubmit = async (data) => {
        dispatch(getAuthorizationUserAction(data))
        reset()
        dispatch(getAuthModalOffAction())
    }

    return (
        <form className={classes.togglePage} onSubmit={handleSubmit(onLoginFormSubmit)} >
            <Input placeholder='Email' type='text'
                   validationError={errors?.email}
                   {...register('email', {
                       required: 'Обязательно к заполнению',
                       pattern: {
                           value: /^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/g,
                           message: 'Некорректный email'
                       }
                   })}
            />
            <Input placeholder='Пароль' type='password'
                   validationError={errors?.password}
                   {...register('password', {
                       required: 'Обязательно к заполнению'
                   })}
            />
            <SubmitInput text='Войти' />
        </form>
    )
}

export default LoginForm;